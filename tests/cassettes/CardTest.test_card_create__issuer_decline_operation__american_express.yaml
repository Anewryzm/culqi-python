interactions:
- request:
    body: '{"card_number": "370002000000008", "expiration_month": "05", "expiration_year":
      "2025", "cvv": "1810", "email": "richardb440@piedpiper.com"}'
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      Authorization:
      - Bearer culiq_api_key
      Connection:
      - keep-alive
      Content-Length:
      - '140'
      Content-type:
      - application/json
      User-Agent:
      - Culqi-API-Python/1.0.4
    method: POST
    uri: https://secure.culqi.com/v2/tokens
  response:
    body:
      string: '{"object":"token","id":"tkn_test_BtqHoRBLa7jeyJ81","type":"card","creation_date":1589954929000,"email":"richardb440@piedpiper.com","card_number":"370002*****0008","last_four":"0008","active":true,"iin":{"object":"iin","bin":"370002","card_brand":"Amex","card_type":"credito","card_category":null,"issuer":{"name":"AMERICAN
        EXPRESS COMPANY","country":"BRAZIL","country_code":"BR","website":null,"phone_number":null},"installments_allowed":[]},"client":{"ip":"190.237.22.191","ip_country":"Peru","ip_country_code":"PE","browser":"UNKNOWN","device_fingerprint":null,"device_type":"Escritorio"},"metadata":{}}'
    headers:
      Connection:
      - keep-alive
      Content-Encoding:
      - UTF-8
      Content-Length:
      - '605'
      Content-Type:
      - application/json;charset=UTF-8
      Date:
      - Wed, 20 May 2020 06:08:49 GMT
      Via:
      - 1.1 a6694d5ca059a1b8b902a7765e513e5c.cloudfront.net (CloudFront)
      X-Amz-Cf-Id:
      - tU2vRe3pcgXewLpNxnR3-G6ioGlBQ0ojOOe6dMpS5jgat1qz6nl6rA==
      X-Amz-Cf-Pop:
      - SCL50-C1
      X-Amzn-Trace-Id:
      - Root=1-5ec4c971-4f9a12485481f880f66d8be8;Sampled=0
      X-Cache:
      - Miss from cloudfront
      x-amz-apigw-id:
      - M0RprGA5oAMFucw=
      x-amzn-Remapped-Content-Length:
      - '605'
      x-amzn-RequestId:
      - 28cdbffa-d464-4556-aafd-8f9be31dc640
    status:
      code: 201
      message: Created
- request:
    body: '{"address": "Avenida Lima 123213", "address_city": "LIMA", "country_code":
      "PE", "email": "richardb440@piedpiper.com", "first_name": "Richard", "last_name":
      "Piedpiper", "phone_number": "+51998989789"}'
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      Authorization:
      - Bearer culiq_api_key
      Connection:
      - keep-alive
      Content-Length:
      - '201'
      Content-type:
      - application/json
      User-Agent:
      - Culqi-API-Python/1.0.4
    method: POST
    uri: https://api.culqi.com/v2/customers
  response:
    body:
      string: '{"object":"customer","id":"cus_test_UMthBMbEoK5sOlEE","creation_date":1589954930377,"email":"richardb440@piedpiper.com","antifraud_details":{"first_name":"Richard","last_name":"Piedpiper","address":"Avenida
        Lima 123213","address_city":"LIMA","country_code":"PE","phone":"+51998989789","object":"client"},"metadata":{}}'
    headers:
      Connection:
      - keep-alive
      Content-Length:
      - '318'
      Content-Type:
      - application/json;charset=UTF-8
      Date:
      - Wed, 20 May 2020 06:08:50 GMT
      Via:
      - 1.1 595890fa6c443730f0ef48eb659a8528.cloudfront.net (CloudFront)
      X-Amz-Cf-Id:
      - FWVNmFxGtjld5oiNr_c3ePZPDlAVLoYQrwbpqpQRlLTVpVvRT5Aijw==
      X-Amz-Cf-Pop:
      - SCL50-C1
      X-Amzn-Trace-Id:
      - Root=1-5ec4c972-f224787ce257e81083994f82;Sampled=0
      X-Cache:
      - Miss from cloudfront
      set-cookie:
      - JSESSIONID=FBD39C0DD1AA20983A319EFD6A3D8617; Path=/api; HttpOnly
      x-amz-apigw-id:
      - M0Rp2EfroAMFtGg=
      x-amzn-RequestId:
      - c1c6e820-78ba-4afa-83f7-0052e20f3319
      x-culqi-environment:
      - test
      x-culqi-tracking-id:
      - '7213418'
      x-culqi-version:
      - 2.0.0
    status:
      code: 201
      message: Created
- request:
    body: '{"token_id": "tkn_test_BtqHoRBLa7jeyJ81", "customer_id": "cus_test_UMthBMbEoK5sOlEE"}'
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      Authorization:
      - Bearer culiq_api_key
      Connection:
      - keep-alive
      Content-Length:
      - '85'
      Content-type:
      - application/json
      User-Agent:
      - Culqi-API-Python/1.0.4
    method: POST
    uri: https://api.culqi.com/v2/cards
  response:
    body:
      string: "{\"object\":\"error\",\"type\":\"card_error\",\"charge_id\":\"chr_test_RD24ZJjKwxvDsR3L\"\
        ,\"code\":\"card_declined\",\"decline_code\":\"issuer_decline_operation\"\
        ,\"merchant_message\":\"Operaci\xF3n denegada. La operaci\xF3n fue denegada\
        \ por el banco emisor de la tarjeta por una raz\xF3n desconocida.\",\"user_message\"\
        :\"La operaci\xF3n ha sido denegada por la entidad emisora de tu tarjeta.\
        \ Cont\xE1ctate con el banco para conocer el motivo de la denegaci\xF3n o\
        \ intenta nuevamente con otra tarjeta.\"}"
    headers:
      Connection:
      - keep-alive
      Content-Length:
      - '465'
      Content-Type:
      - application/json;charset=UTF-8
      Date:
      - Wed, 20 May 2020 06:08:52 GMT
      Via:
      - 1.1 595890fa6c443730f0ef48eb659a8528.cloudfront.net (CloudFront)
      X-Amz-Cf-Id:
      - VGrk0GRIiDpckVe0gViV4GZBmMhGWLmoDW5fDJ5Q-3poTN_EZnjzhw==
      X-Amz-Cf-Pop:
      - SCL50-C1
      X-Amzn-Trace-Id:
      - Root=1-5ec4c972-c351804de1eecabd4db13318;Sampled=0
      X-Cache:
      - Error from cloudfront
      set-cookie:
      - JSESSIONID=44CF7E29C0234057C635242E5C3DD68F; Path=/api; HttpOnly
      x-amz-apigw-id:
      - M0Rp7GMmIAMFqgg=
      x-amzn-RequestId:
      - 4e2982b4-213e-4dca-834b-604f95572b75
      x-culqi-environment:
      - test
      x-culqi-tracking-id:
      - '7213419'
      x-culqi-version:
      - 2.0.0
    status:
      code: 400
      message: Bad Request
version: 1
